<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Divyanshu's Stopwatch</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&family=Raleway:wght@500&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      font-family: 'Raleway', sans-serif;
      background: #121212;
      color: #eeeeee;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 40px 20px;
    }
    h1 {
      font-size: 32px;
      margin-bottom: 10px;
      color: #00e676;
      text-shadow: 0 0 10px #00e676;
    }
    #display {
      font-family: 'Orbitron', monospace;
      font-size: 64px;
      margin: 20px 0;
      color: #ffffff;
      text-shadow: 0 0 12px #00b0ff;
    }
    .buttons { margin: 15px 0; }
    .buttons button {
      background: #00e5ff;
      border: none;
      color: #121212;
      padding: 10px 20px;
      margin: 5px;
      font-size: 18px;
      cursor: pointer;
      border-radius: 8px;
    }
    .buttons button:hover { background: #00bcd4; }
    #motivation, #reward, #next-goal, #history-title {
      margin-top: 20px;
      text-align: center;
      min-height: 24px;
    }
    #motivation {
      font-size: 18px;
      color: #80d8ff;
      animation: fadeText 6s infinite;
    }
    #reward { font-size: 18px; font-weight: bold; color: #69f0ae; }
    #next-goal { font-size: 16px; color: #ffd740; }
    #history-title {
      font-size: 16px;
      color: #90caf9;
      margin-bottom: 5px;
    }
    #history {
      font-size: 15px;
      background: #1e1e1e;
      border: 1px solid #424242;
      border-radius: 8px;
      padding: 10px;
      max-width: 300px;
    }
    #analysis-btn {
      margin-top: 20px;
      font-size: 16px;
      background: #ffd740;
      border: none;
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      color: #000;
    }
    @keyframes fadeText {
      0% {opacity: 0;}
      10% {opacity: 1;}
      90% {opacity: 1;}
      100% {opacity: 0;}
    }
  </style>
</head>
<body>
  <h1>Divyanshu‚Äôs Stopwatch ‚è±Ô∏è</h1>
  <div id="display">0 min 0 sec</div>

  <div class="buttons">
    <button onclick="startTimer()">Start</button>
    <button onclick="pauseTimer()">Pause</button>
    <button onclick="resetTimer()">Reset</button>
  </div>

  <div id="motivation">Don't look here, I'm working fine. You go study!</div>
  <div id="reward"></div>
  <div id="next-goal"></div>
  <div id="history-title">üìÖ Your Last 5 Days (Saved Locally)</div>
  <div id="history"></div>
  <button id="analysis-btn" onclick="window.location.href='analysis.html'">View Study Analysis ‚û§</button>

  <script>
    let minutes = 0;
    let seconds = 0;
    let interval = null;
    let sessionStart = null;
    const messages = [
      "Don't look here, I'm working fine. You go study!",
      "Be the one who outlasts the rest‚Äîfocus beats talent!",
      "Every minute counts. One step closer to victory!"
    ];
    let messageIndex = 0;
    const today = new Date().toISOString().slice(0, 10);
    let studyLog = JSON.parse(localStorage.getItem("studyLog") || "{}");

    function updateDisplay() {
      document.getElementById("display").textContent = `${minutes} min ${seconds} sec`;
      updateReward();
    }

    function updateReward() {
      const reward = document.getElementById("reward");
      const nextGoal = document.getElementById("next-goal");
      if (minutes >= 600) {
        reward.textContent = "üéØ You‚Äôre going to get AIR!";
        nextGoal.textContent = "You‚Äôve unlocked all levels. Now chase mastery.";
      } else if (minutes >= 480) {
        reward.textContent = "üèÜ You've left 80% of competitors behind!";
        nextGoal.textContent = "Next Goal: 600 min ‚Äî You‚Äôre going to get AIR!";
      } else if (minutes >= 360) {
        reward.textContent = "üî• You're among AIR contenders. Keep pushing!";
        nextGoal.textContent = "Next Goal: 480 min ‚Äî Leave 80% of competitors behind!";
      } else if (minutes >= 180) {
        reward.textContent = "‚ö° You‚Äôre a challenger in this competition!";
        nextGoal.textContent = "Next Goal: 360 min ‚Äî Join AIR contenders!";
      } else if (minutes >= 60) {
        reward.textContent = "üß† Solid warmup. Ready to go beyond!";
        nextGoal.textContent = "Next Goal: 180 min ‚Äî Become a challenger!";
      } else {
        reward.textContent = "‚è≥ Let‚Äôs build momentum!";
        nextGoal.textContent = "Next Goal: 60 min ‚Äî Reach solid warmup stage!";
      }
    }

    function startTimer() {
      if (!interval) {
        interval = setInterval(() => {
          seconds++;
          if (seconds >= 60) {
            seconds = 0;
            minutes++;
          }
          updateDisplay();
          saveProgress();
        }, 1000);
        sessionStart = new Date().toLocaleTimeString();
      }
    }

    function pauseTimer() {
      clearInterval(interval);
      interval = null;
      storeToday();
      logSession();
    }

    function resetTimer() {
      pauseTimer();
      minutes = 0;
      seconds = 0;
      sessionStart = null;
      updateDisplay();
    }

    function saveProgress() {
      localStorage.setItem("todayMinutes", JSON.stringify({ date: today, min: minutes, sec: seconds }));
    }

    function restoreProgress() {
      const saved = JSON.parse(localStorage.getItem("todayMinutes"));
      if (saved && saved.date === today) {
        minutes = saved.min;
        seconds = saved.sec;
      }
    }

    function logSession() {
      const end = new Date().toLocaleTimeString();
      if (!sessionStart) return;
      const history = JSON.parse(localStorage.getItem("sessionHistory") || "{}");
      if (!history[today]) history[today] = [];
      history[today].push({ from: sessionStart, to: end, duration: minutes });
      localStorage.setItem("sessionHistory", JSON.stringify(history));
    }

    function storeToday() {
      studyLog[today] = minutes;
      const dates = Object.keys(studyLog).sort();
      while (dates.length > 5) {
        delete studyLog[dates[0]];
        dates.shift();
      }
      localStorage.setItem("studyLog", JSON.stringify(studyLog));
      showHistory();
    }

    function showHistory() {
      const historyDiv = document.getElementById("history");
      historyDiv.innerHTML = "";
      const entries = Object.entries(studyLog).sort((a, b) => b[0].localeCompare(a[0]));
      entries.forEach(([date, value]) => {
        historyDiv.innerHTML += `<div>${date}: ${value} min</div>`;
      });
    }

    setInterval(() => {
      messageIndex = (messageIndex + 1) % messages.length;
      document.getElementById("motivation").textContent = messages[messageIndex];
    }, 6000);

    restoreProgress();
    updateDisplay();
    showHistory();
  </script>
</body>
</html>
